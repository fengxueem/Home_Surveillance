# Day 1

---

### 材料

1. 可以刷OpenWRT的路由器一只，推荐TP-link WR703N，原因**便宜**（某宝上二手的只需要40RMB左右），在下面的教程当中就称其为wifi模块。
2. 一台Linux系统电脑，我用的是Ubuntu系统。
3. 网线一根，用于连接wifi模块和电脑。

---

### 思路：利用wifi模块构建局域网（简称AP模式）
1. 这一步是所有后续的基础，目的是为了熟悉OpenWRT。OpenWRT系统自带了一个192.168.1.1：80上面的网页服务器叫做Luci，它和我们一般接触到的路由器的管理页面是同一个东西，在上面可以很方便的设置路由器的功能。但是我们项目当中不推荐使用Luci去操作，第一它很大！我们选用的TP-link WR703N的SquashFS的大小只有4MB，每一个bit都很关键，所以一个本质是UI的软件对于开发者就没有太大的必要;第二有了图形化用户界面之后对于我们抱着学习目的的开发者来说会存在依赖性，Luci能完成的东西越多，我们自己能学习到的东西就越少。
2. AP模式就是以这个wifi模块为路由器，DHCP动态分配ip给加入的设备。所以第二点就是熟悉一下计算机网络的最基本内容，如何以一个路由器的视角看局域网。首先路由器是作为主角分配ip给所有加入它的设备，这就默认了包括路由器在内的所有设备都默认在一个网段当中，这一点虽然看似一点不重要，但我在实际操作当中就因为没有考虑到两个通信的设备是否在同一网段中，而尝试两者不通过路由进行通信导致失败，还到处找是不是网线没插好，电源有没有稳定之类的问题。所以强调一下，当wifi模块和电脑用网线直连的时候要保证能通信就需要一个大前提：电脑ip所在的网段必须和wifi模块的ip属于同一网段！

---

### 步骤
1. 刷机。给wifi模块刷不死引导，以及OpenWRT，具体步骤请看《[OpenWRT刷机入门](http://blog.csdn.net/u014795817/article/details/74504791)》。OpenWRT官方给出15.05版本的针对TP-Link WR703N这款路由器的固件可以在官网的[这个地方找到](https://downloads.openwrt.org/chaos_calmer/15.05/ar71xx/generic/)，在网页里搜索关键字703，然后你就可以发现名字是这个的openwrt-15.05-ar71xx-generic-tl-wr703n-v1-squashfs-factory.bin，官方固件。有了官方固件之后就参照[OpenWRT刷机入门](http://blog.csdn.net/u014795817/article/details/74504791)》里面的内容刷起！
2. wifi模块连电脑。用网线将电脑和OpenWRT连接起来，设置电脑的ip和子网掩码为192.168.1.2/24。这样就保证电脑和wifi模块在同一网段下（因为OpenWRT默认的ip网段就是192.168.1.XXX，如果之前你有更改过默认的ip记得只需要给电脑也配上同网段的ip就好），可以通过网线直接通信。Ubuntu系统的电脑设置ip很简单，在插上网线之后，电脑的网线接口（RJ45口）的数据灯闪烁就代表链接成功，然后在Ubuntu系统设置->网络当中找到有线连接，修改它的ipv4选项卡下面的ip就可以了，更加具体的可以看[这里](https://jingyan.baidu.com/article/b7001fe18f85fe0e7282ddaf.html)。
3. 登录OpenWRT系统。Ubuntu电脑打开terminal，快捷键是`ctrl+alt+t`。如果已经用ssh命令登录过OpenWRT系统的就直接`ssh root@192.168.1.1`，然后输入密码即可。如果是第一次登录OpenWRT的系统，那么需要先`telnet 192.168.1.1`去用不加密方式登录系统，登录之后键入`passwd`命令去给root用户设置密码，设置好密码之后就必须要用ssh的方式登录了。
4. 使能wifi功能。利用`cd /etc/config/`命令进入到/etc/config/目录下，通过`ls -altF`查看这个目录下的所有文件，我们要使能wifi功能其实需要操作的文件是wireless。ok，没问题，这个文件默认的OpenWRT系统固件里面都有的。直接`vim wireless`去编辑。vim是一款老的很的命令行文本编辑器，里面的操作习惯和我们现在主流编辑器比较不同，需要一定时间的习惯和适应，推荐台湾同学的一篇很认真的[学习文档](http://www.study-area.org/tips/vim/index.html)。vim很难一下子掌握，但是我们不得不用它，因为在我们这个TP-link WR703N的OpenWRT中并没有和我们提供其他的编辑器，不过还有一个巨大的原因，它虽然老，但是特别优秀，快捷键的设置考虑到了方方面面，简而言之就是牛！学了它的基本内容不会吃亏，不会上当的。所以在看台湾同学的文章的时候，如果你觉得已经知道怎么在vim当中写一个文档了，那就回过来继续看我的教程吧。编辑wireless的内容其实很简单，里面有一行option disabled "1"，我们所有要做的内容就是把它删除！！然后你还可以在wifi-iface部分看到我们的AP模式默认的ssid和密码，所以我们就是在这里给AP设置密码和ssid的。ok，保存退出之后，用`wifi`命令重新启动一下wifi功能，不久之后你就可以在电脑上搜索到一个名字是OpenWRT的wifie热点拉！恭喜！！
5. 用你手上的其他设备去连接这个热点试试吧！连上之后就代表我们第一天的内容结束了！

---

### 进阶
如果你是一个和我一样好奇心很重的人，对/etc/config/wireless里面这么多陌生设置觉得有必要粗浅了解一下的话，请看官方的[英文文档](https://wiki.openwrt.org/doc/uci/wireless)！This could not harm you. Read it, my geek friend.

